인프런 스프링강의3
=======
## 컨트롤러간의 객체 의존관계
- 서로 같은 객체를 new로 생성 할 필요가 없으므로 스프링컨테이너에서 선언하고 공용으로 사용하는것이 좋음
- @Service, @Repository어노테이션을 사용하여 객체를 선언하면 자동으로 스프링 컨테이너에 등록이 됨
- @Autowired를 사용하여 컨트롤러에서 객체 생성시 스프링빈에 등록되어있는 객체를 끌어와서 사용할 수 있음
- 이러한 방식을 컴포넌트 스캔과 자동 의존관계 설정방식이라 함
- @Component를 사용하면 스프링 빈으로 자동 등록되며, @Controller, @Service, @Repositiry 이 세가지 어노테이션 모두 컴포넌트 어노테이션을 포함하고 있음
- spring 프로젝트의 application파일과 같은 패키지 혹은 그 하위 패키지만 기본적으로 스프링 빈으로 설정 가능함(@SpringBootApplication어노테이션이 기본적으로 @Componentscan어노테이션을 포함하기 때문)
- 스프링 컨테이너에서 스프링 빈을 등록할 대, 기본으로 싱글톤(유일하게 하나만 등록해서 공유하는 방식)으로 등록한다.

## 자바코드로 직접 스프링빈을 등록하는 방식
- @Configuration 어노테이션을 사용하는 새로운 자바 클래스에서 @Bean어노테이션을 사용하여 객체 생성

---------

## DB 연동 후 테스트
### @SpringBootTest
- 어노테이션 사용 시 스프링 컨테이너와 테스트를 함께 실행한다.
### @Transactional
- 테스트 코드를 사용할땐 재사용이 가능해야 한다
- 테스트시 데이터 자동으로 commit되면 재사용 시 DB에 변화가 일어나기 떄문에 위 조건이 부합하지 않게됨
- 위 어노테이션을 사용할 경우 테스트가 끝난 뒤에 데이터를 다시 롤백해줌 

### 단위 테스트
- 스프링 컨테이너에 의존하는 테스틑 스프링을 직접 실행하는 과정을 거치기 때문에 런타임이 훨씬 오래걸림 
- 때문에 순수한 자바 코드로 잘게 쪼개서 테스트 하는 코드가 더욱 바람직함

## JPA(Java Presistence API)
- 객체와 DB간의 매핑을 위한 프레임워크
- 기존의 반복코드와 기본적인 sql을 자동으로 생성해줌
- sql과 데이터 중심 설계에서 객체 중심설계로 패러다임 전환 가능
- jpa 라이브러리 내부에 jdbc관련 라이브러리가 포함되어있음
- jpa를 통한 모든 데이터 변경은 트랙잭션 안에서 실행해야 함
- 라이브러리 내부 클래스인 Entitymanager를 생성하여 사용

## 스프링 데이터 JPA
- JpaRepository라이브러리를 통하여 사용
- 위 라이브러리는 기본적인 CRUD기능을 포함함
- findByName()  같이 메서드 이름만으로 조회가능
- 복잡한 쿼리문이 필요한 경우엔 Querydsl 라이브러리를 통하여 동적쿼리도 자바 코드로 작성 가능함